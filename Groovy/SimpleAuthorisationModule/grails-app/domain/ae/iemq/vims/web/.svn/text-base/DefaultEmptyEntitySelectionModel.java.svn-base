package ae.iemq.vims.web;

import java.util.ArrayList;
import java.util.List;

import org.apache.tapestry.form.IPropertySelectionModel;

import ae.iemq.vims.domain.BaseEntity;

/**
 * A property selection model for entities where the first element is always a
 * null value with the label "Please select..."
 * 
 * @param <T>
 */
public class DefaultEmptyEntitySelectionModel<T extends BaseEntity> implements
		IPropertySelectionModel {

	private static final String PLEASE_SELECT = "Please select...";
	private String firstOptionString;
	private List<T> entities;

	public DefaultEmptyEntitySelectionModel(List<T> entities) {
		this.entities = new ArrayList<T>();
		this.entities.add(null);
		this.entities.addAll(entities);
	}
	
	public DefaultEmptyEntitySelectionModel(List<T> entities, String firstOptionString){
		this(entities);
		setFirstOptionString(firstOptionString);
	}

	public String getLabel(int index) {
		if(getFirstOptionString() == null || getFirstOptionString().trim().equalsIgnoreCase("")){
			setFirstOptionString(PLEASE_SELECT);
		}
		return index == 0 ? getFirstOptionString() : entities.get(index).toString();
	}

	public T getOption(int index) {
		if (entities.size() == 0)
			return null;

		if (index <= 0 || index >= getOptionCount())
			return null;

		return entities.get(index);
	}

	public int getOptionCount() {
		return entities.size();
	}

	public String getValue(int index) {
		return Integer.toString(index);
	}

	public T translateValue(String index) {
		if (index == null || index.length() == 0)
			return null;

		return getOption(Integer.parseInt(index));
	}

	public boolean isDisabled(int index) {
		return false;
	}

	/**
	 * @return the nullLabel
	 */
	public String getFirstOptionString() {
		return firstOptionString;
	}

	/**
	 * @param nullLabel the nullLabel to set
	 */
	public void setFirstOptionString(String firstOptionString) {
		this.firstOptionString = firstOptionString;
	}
}
